{"ast":null,"code":"var util = require('../util');\nfunction JsonBuilder() {}\nJsonBuilder.prototype.build = function (value, shape) {\n  return JSON.stringify(translate(value, shape));\n};\nfunction translate(value, shape) {\n  if (!shape || value === undefined || value === null) return undefined;\n  switch (shape.type) {\n    case 'structure':\n      return translateStructure(value, shape);\n    case 'map':\n      return translateMap(value, shape);\n    case 'list':\n      return translateList(value, shape);\n    default:\n      return translateScalar(value, shape);\n  }\n}\nfunction translateStructure(structure, shape) {\n  if (shape.isDocument) {\n    return structure;\n  }\n  var struct = {};\n  util.each(structure, function (name, value) {\n    var memberShape = shape.members[name];\n    if (memberShape) {\n      if (memberShape.location !== 'body') return;\n      var locationName = memberShape.isLocationName ? memberShape.name : name;\n      var result = translate(value, memberShape);\n      if (result !== undefined) struct[locationName] = result;\n    }\n  });\n  return struct;\n}\nfunction translateList(list, shape) {\n  var out = [];\n  util.arrayEach(list, function (value) {\n    var result = translate(value, shape.member);\n    if (result !== undefined) out.push(result);\n  });\n  return out;\n}\nfunction translateMap(map, shape) {\n  var out = {};\n  util.each(map, function (key, value) {\n    var result = translate(value, shape.value);\n    if (result !== undefined) out[key] = result;\n  });\n  return out;\n}\nfunction translateScalar(value, shape) {\n  return shape.toWireFormat(value);\n}\n\n/**\n * @api private\n */\nmodule.exports = JsonBuilder;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}